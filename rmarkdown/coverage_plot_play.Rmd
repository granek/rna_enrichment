---
title: "Mito coverage plots"
output:
  html_document:
    toc: false
---

```{r}
library(Rsamtools)
library(ggbio)
library(fs)
library(dplyr)
bam_dir = "/workspace/2018_tot_samples/star_out"
```

```{r}
tot_bam_files = dir_ls(bam_dir,glob = "*TOT*L00*.bam") 
tot_bams = BamFileList(tot_bam_files, paste0(tot_bam_files, ".bai"))
tot_bam_files
```

```{r}
tot_L1_bam_files = dir_ls(bam_dir,glob = "*TOT*L001*.bam") 
tot_L1_bams = BamFileList(tot_L1_bam_files, paste0(tot_L1_bam_files, ".bai"))
tot_L1_bam_files
```

```{r}
cur_range = GRanges(seqnames = "Mt", 
                              IRanges(1, 26000), strand = "*")

autoplot(tot_L1_bams, which = cur_range) +
  xlim(cur_range)
```

```{r}
cur_range = GRanges(seqnames = "Mt", 
                              IRanges(6500, 9500), strand = "*")

autoplot(tot_L1_bams, which = cur_range) +
  xlim(cur_range)
```



```{r}
tot_bams[[1]]$path
```

```{r}
cur_range = GRanges(seqnames = "Mt", 
                              IRanges(6500, 9500), strand = "*")

curbam = tot_bams[[1]]
autoplot(curbam, which = cur_range, color="red") +
  xlim(cur_range) +
  ggtitle(basename(curbam$path))

curbam = tot_bams[[5]]
autoplot(curbam, which = cur_range, color="red") +
  xlim(cur_range) +
  ggtitle(basename(curbam$path))
```


